
$.ajaxSetup({cache:false,dataType:"text"});$(document).on("click","a",function(a){a.preventDefault();if(!window.open($(this).attr("href"),"_blank")){alert("Please allow popups for this site")}});var $module_container=$(".module_container");var _tracer=new Tracer();var initEditor=function(b){var a=ace.edit(b);a.setTheme("ace/theme/tomorrow_night_eighties");a.session.setMode("ace/mode/javascript");a.$blockScrolling=Infinity;return a};var dataEditor=initEditor("data");var codeEditor=initEditor("code");var lastDir=null;dataEditor.on("change",function(){var data=dataEditor.getValue();if(lastDir){cachedFile[lastDir].data=data}try{eval(data);lastModule=tracer&&tracer.module;_tracer=tracer}catch(err){}_tracer.reset()});codeEditor.on("change",function(){var a=codeEditor.getValue();if(lastDir){cachedFile[lastDir].code=a}});var cachedFile={};var loading=false;var loadFile=function(e,b,d,a){if(checkLoading()){return}lastData=null;$("#explanation").html(a);var c=lastDir="./algorithm/"+e+"/"+b+"/"+d+"/";if(cachedFile[c]&&cachedFile[c].data!==undefined&&cachedFile[c].code!==undefined){dataEditor.setValue(cachedFile[c].data,-1);codeEditor.setValue(cachedFile[c].code,-1)}else{loading=true;cachedFile[c]={};dataEditor.setValue("");codeEditor.setValue("");var f=function(g,j,h){loading=false;alert("AJAX call failed: "+j+", "+h)};$.get(c+"data.js",function(g){cachedFile[c].data=g;dataEditor.setValue(g,-1);$.get(c+"code.js",function(h){cachedFile[c].code=h;codeEditor.setValue(h,-1);loading=false}).fail(f)}).fail(f)}};var checkLoading=function(){if(loading){showErrorToast("Wait until it completes loading of previous file.");return true}return false};var loadAlgorithm=function(c,a){if(checkLoading()){return}$("#list > button").removeClass("active");$('[data-category="'+c+'"][data-algorithm="'+a+'"]').addClass("active");$("#btn_desc").click();$("#category").html(list[c].name);$("#algorithm, #desc_title").html(list[c].list[a]);$("#tab_desc > .wrapper").empty();$(".files_bar").empty();$("#explanation").html("");lastDir=null;dataEditor.setValue("");codeEditor.setValue("");var b="./algorithm/"+c+"/"+a+"/";$.getJSON(b+"desc.json",function(g){var e=g.files;delete g.files;var l=$("#tab_desc > .wrapper");l.empty();for(var k in g){if(k){l.append($("<h3>").html(k))}var j=g[k];if(typeof j==="string"){l.append($("<p>").html(j))}else{if(Array.isArray(j)){var h=$("<ul>");l.append(h);j.forEach(function(n){h.append($("<li>").html(n))})}else{if(typeof j==="object"){var h=$("<ul>");l.append(h);for(var d in j){h.append($("<li>").append($("<strong>").html(d)).append(" "+j[d]))}}}}}$(".files_bar").empty();var m=false;for(var f in e){(function(p,o){var n=$("<button>").append(p).click(function(){loadFile(c,a,p,o);$(".files_bar > button").removeClass("active");$(this).addClass("active")});$(".files_bar").append(n);if(!m){m=true;n.click()}})(f,e[f])}})};var list={};$.getJSON("./algorithm/category.json",function(b){list=b;var c=false;for(var a in list){(function(g){var f=$('<button class="category">').append(list[g].name);$("#list").append(f);var d=list[g].list;for(var e in d){(function(k,h,j){var l=$('<button class="indent">').append(h[j]).attr("data-algorithm",j).attr("data-category",k).click(function(){loadAlgorithm(k,j)});$("#list").append(l);if(!c){c=true;l.click()}})(g,d,e)}})(a)}});var sidemenu_percent;$("#navigation").click(function(){var a=$(".sidemenu");var b=$(".workspace");a.toggleClass("active");$(".nav-dropdown").toggleClass("fa-caret-down fa-caret-up");if(a.hasClass("active")){a.css("right",(100-sidemenu_percent)+"%");b.css("left",sidemenu_percent+"%")}else{sidemenu_percent=b.position().left/$("body").width()*100;a.css("right",0);b.css("left",0)}_tracer.resize()});var showErrorToast=function(a){var b=$('<div class="toast error">').append(a);$(".toast_container").append(b);setTimeout(function(){b.fadeOut(function(){b.remove()})},3000)};$("#btn_run").click(function(){try{eval(dataEditor.getValue());lastModule=tracer&&tracer.module;_tracer=tracer;_tracer.reset();eval(codeEditor.getValue());_tracer.visualize()}catch(err){console.error(err);showErrorToast(err)}});$("#btn_pause").click(function(){if(_tracer.isPause()){_tracer.resumeStep()}else{_tracer.pauseStep()}});$("#btn_prev").click(function(){_tracer.pauseStep();_tracer.prevStep()});$("#btn_next").click(function(){_tracer.pauseStep();_tracer.nextStep()});$("#btn_desc").click(function(){$(".tab_container > .tab").removeClass("active");$("#tab_desc").addClass("active");$(".tab_bar > button").removeClass("active");$(this).addClass("active")});$("#btn_trace").click(function(){$(".tab_container > .tab").removeClass("active");$("#tab_trace").addClass("active");$(".tab_bar > button").removeClass("active");$(this).addClass("active")});$(window).resize(_tracer.resize);var dividers=[["v",$(".sidemenu"),$(".workspace")],["v",$(".viewer_container"),$(".editor_container")],["h",$(".module_container"),$(".tab_container")],["h",$(".data_container"),$(".code_container")]];for(var i=0;i<dividers.length;i++){var divider=dividers[i];(function(c){var a=c[0]=="v";var d=c[1];var f=c[2];var b=d.parent();var h=5;var k=$('<div class="divider">');if(a){k.addClass("vertical");var m=-h/2;k.css({top:0,bottom:0,left:m,width:h});var g,j=false;k.mousedown(function(n){g=n.pageX;j=true});$(document).mousemove(function(p){if(j){var n=f.position().left+p.pageX-g;var o=n/b.width()*100;o=Math.min(90,Math.max(10,o));d.css("right",(100-o)+"%");f.css("left",o+"%");g=p.pageX;_tracer.resize()}});$(document).mouseup(function(n){j=false})}else{k.addClass("horizontal");var l=-h/2;k.css({top:l,height:h,left:0,right:0});var e,j=false;k.mousedown(function(n){e=n.pageY;j=true});$(document).mousemove(function(o){if(j){var p=f.position().top+o.pageY-e;var n=p/b.height()*100;n=Math.min(90,Math.max(10,n));d.css("bottom",(100-n)+"%");f.css("top",n+"%");e=o.pageY;_tracer.resize()}});$(document).mouseup(function(n){j=false})}f.append(k)})(divider)}$module_container.mousedown(function(a){_tracer.mousedown(a)});$module_container.mousemove(function(a){_tracer.mousemove(a)});$(document).mouseup(function(a){_tracer.mouseup(a)});$module_container.bind("DOMMouseScroll mousewheel",function(a){_tracer.mousewheel(a)});var getParameterByName=function(a){url=window.location.href;a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),b=c.exec(url);if(!b){return null}if(!b[2]){return""}return decodeURIComponent(b[2].replace(/\+/g," "))};$(document).ready(function(){if(/[?&]scratch-paper=/.test(location.search)){var a=getParameterByName("scratch-paper");console.log(a);loadScratchPaper(a)}});var shareScratchPaper=function(){var b={data:dataEditor.getValue(),code:codeEditor.getValue()};var a={description:"Shared scratch paper","public":true,files:{"scratch-paper.json":{content:JSON.stringify(b)}}};$.post("https://api.github.com/gists",JSON.stringify(a),function(c){var d=JSON.parse(c);console.log(window.location.origin+"/?scratch-paper="+d.id)})};var loadScratchPaper=function(a){$.get("https://api.github.com/gists/"+a,function(b){var d=JSON.parse(b);var c=d.files["scratch-paper.json"].content;console.log(c)})};